webpackJsonp([3],{"0mKM":function(t,e){},"PRf/":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=a("W1GH"),r=(n=i)&&n.__esModule?n:{default:n};var o=[{title:"发药时间",dataIndex:"opertime",key:"opertime",width:150},{title:"处方类型",dataIndex:"cftype",key:"cftype",ellipsis:!0},{title:"就诊号",dataIndex:"pid",key:"pid",ellipsis:!0},{title:"患者",dataIndex:"patient",key:"patient",ellipsis:!0},{title:"年龄",dataIndex:"age",key:"age",ellipsis:!0},{title:"费别",dataIndex:"feibie",key:"feibie",ellipsis:!0},{title:"诊断",dataIndex:"disease",key:"disease",ellipsis:!0,customRender:function(t,e){return e.disease2?t+","+e.disease2:t}},{title:"医生",dataIndex:"doctor",key:"doctor",ellipsis:!0},{title:"金额",dataIndex:"totalprice",key:"totalprice",ellipsis:!0,customRender:function(t,e,a){return r.default.formatMoney(t,"￥",2,",",".")}}];e.default=o},QFvR:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(a("bOdI")),i=(o(a("7+uW")),o(a("PRf/"))),r=o(a("PJh5"));function o(t){return t&&t.__esModule?t:{default:t}}e.default={name:"Cf",data:function(){return{moment:r.default,doctors:[],dateRange:{"今日":[(0,r.default)().startOf("day"),(0,r.default)().endOf("day")],"昨天":[(0,r.default)().subtract(1,"days").startOf("day"),(0,r.default)().subtract(1,"days").endOf("day")],"前天":[(0,r.default)().subtract(2,"days").startOf("day"),(0,r.default)().subtract(2,"days").endOf("day")],"近一周":[(0,r.default)().subtract(7,"days").startOf("day"),(0,r.default)().endOf("day")],"近一月":[(0,r.default)().subtract(1,"months").startOf("day"),(0,r.default)().endOf("day")],"本月":[(0,r.default)().startOf("month"),(0,r.default)().endOf("day")],"本年":[(0,r.default)().startOf("year"),(0,r.default)().endOf("day")]},data:[],columns:i.default,pagination:{current:1,pageSize:8,showTotal:function(t,e){return e[0]+"至"+e[1]+"，共 "+t+" 条记录数"}},fytime:[(0,r.default)().startOf("month"),(0,r.default)().endOf("day")],filter:{doctor:"",patient:""},tongji:[],tjcols:[{title:"医生",key:"医生",dataIndex:"医生"},{title:"金额",key:"金额",dataIndex:"金额",ellipsis:!0,width:150},{title:"人次",key:"人次",dataIndex:"人次"},{title:"处方数",key:"处方数",dataIndex:"处方数"},{title:"自费",key:"自费",dataIndex:"自费"},{title:"医保",key:"医保",dataIndex:"医保"},{title:"普通",key:"普通",dataIndex:"普通"},{title:"儿科",key:"儿科",dataIndex:"儿科"},{title:"精二",key:"精二",dataIndex:"精二"},{title:"急诊",key:"急诊",dataIndex:"急诊"},{title:"麻醉",key:"麻醉",dataIndex:"麻醉"},{title:"静滴",key:"静滴",dataIndex:"静滴"}],innerColumns:[{title:"组号",key:"gid",dataIndex:"gid",width:50},{title:"药品名称",key:"drug",dataIndex:"drug"},{title:"规格",key:"spci",dataIndex:"spci"},{title:"用法用量",customRender:function(t,e,a){return e.yongliang+e.danwei+"  "+e.cishu+"  "+e.yongfa}},{title:"数量",key:"quantity",dataIndex:"quantity",width:50},{title:"单位",key:"unit",dataIndex:"unit",width:50}],innerData:[],groupData:[{name:"doctor",label:"医生",groupFn:function(t){return t.doctor}},{name:"opertimeByDay",label:"日期(按日)",groupFn:function(t){return t.opertime.substr(0,10)}},{name:"opertimeByMonth",label:"日期(按月)",groupFn:function(t){return t.opertime.substr(0,7)}},{name:"department",label:"科室",groupFn:function(t){return t.department}},{name:"gender",label:"性别",groupFn:function(t){return t.gender}},{name:"totalprice",label:"处方金额",groupFn:function(t){var e=t.totalprice;return e<=50?"<=50元":e>50&&e<=100?"50至100元":">100元"}}],currentGroup:"doctor"}},mounted:function(){var t=this;this.axios.get("/springDemo/api/getDoctors.do").then(function(e){return t.doctors=e.data}),this.innerColumns.forEach(function(t){return t.align="center"}),this.tjcols.forEach(function(t){return t.align="center"})},watch:{currentGroup:function(){console.log(this.currentGroup),this.groupByCustome()}},methods:{query:function(){this.pagination.current=1,this.fetch()},fetch:function(){var t=this;this.filter.beginTime=this.fytime[0].format("YYYY-MM-DD HH:mm:ss"),this.filter.endTime=this.fytime[1].format("YYYY-MM-DD HH:mm:ss"),this.axios.get("/springDemo/api/CfHead.do",{params:this.filter}).then(function(e){t.data=e.data,t.groupByCustome()})},handleTableChange:function(t){this.pagination.current=t.current},groupByCustome:function(){var t=this,e=this._.find(this.groupData,function(e){return e.name==t.currentGroup});console.log(e),this.tongji=this._.chain(this.data).groupBy(function(t){return e.groupFn(t)}).map(function(a,i,r){var o=t._.countBy(a,"feibie"),l=t._.countBy(a,"cftype"),d=t.$accounting.formatMoney(t._.sumBy(a,"totalprice"),"￥",2,",","."),u=t._.uniqBy(a,"pid").length,s=a.length,c={"静滴":0};a.forEach(function(t){t.cfDetail.some(function(t){return"静滴"==t.yongfa})&&c["静滴"]++});var f=e.label;return t.tjcols[0].title=f,t.tjcols[0].label=f,t.tjcols[0].dataIndex=f,t._.defaults((0,n.default)({},f,i),o,l,{"金额":d},{"人次":u},{"处方数":s},c)}).value(),console.log(this.tongji)},expandInner:function(t,e){console.log(e),t&&(this.innerData=e.cfDetail)}}}},jXCt:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("QFvR"),i=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);var o=a("pazr");var l=function(t){a("0mKM")},d=a("VU/8")(i.a,o.a,!1,l,"data-v-183a1af2",null);e.default=d.exports},pazr:function(t,e,a){"use strict";var n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-page-header",{staticStyle:{border:"1px solid rgb(235, 237, 240)"},attrs:{title:"处方明细","sub-title":""}},[a("template",{slot:"extra"},[t._v("\n    发药时间：\n   "),a("a-range-picker",{attrs:{showTime:!1,format:"YYYY-MM-DD",ranges:t.dateRange},model:{value:t.fytime,callback:function(e){t.fytime=e},expression:"fytime"}}),t._v("\n      医生：\n  "),a("a-select",{staticStyle:{width:"120px"},on:{change:t.handleChange},model:{value:t.filter.doctor,callback:function(e){t.$set(t.filter,"doctor",e)},expression:"filter.doctor"}},[a("a-select-option",{attrs:{value:""}},[t._v("所有医生")]),t._v(" "),t._l(t.doctors,function(e,n){return a("a-select-option",{key:n,attrs:{value:e}},[t._v("\n      "+t._s(e)+"\n    ")])})],2),t._v("\n      患者：\n  "),a("a-input",{staticStyle:{width:"100px"},attrs:{placeholder:"患者姓名",allowClear:"",maxLength:6},model:{value:t.filter.patient,callback:function(e){t.$set(t.filter,"patient",e)},expression:"filter.patient"}}),t._v(" "),a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:t.query}},[t._v("查询")])],1),t._v(" "),a("a-tabs",{attrs:{"default-active-key":"1"},on:{change:t.callback}},[a("a-tab-pane",{key:"1",attrs:{tab:"处方明细表"}},[a("a-table",{attrs:{columns:t.columns,"data-source":t.data,bordered:"",size:"small",rowKey:"opertime",expandRowByClick:!0,pagination:t.pagination,scroll:{y:350}},on:{change:t.handleTableChange,expand:t.expandInner}},[a("a-table",{staticStyle:{background:"lightgoldenrodyellow"},attrs:{slot:"expandedRowRender",bordered:"",size:"small",columns:t.innerColumns,"data-source":t.innerData,pagination:!1,rowKey:"id"},slot:"expandedRowRender"})],1)],1),t._v(" "),a("a-tab-pane",{key:"2",staticStyle:{background:"whitesmoke","text-align":"center"},attrs:{tab:"统计明细表","force-render":""}},[t._v("\n      选择分组依据:\n      "),t._l(t.groupData,function(e,n){return a("a-radio-group",{key:n,attrs:{name:"radioGroup",buttonStyle:"solid"},model:{value:t.currentGroup,callback:function(e){t.currentGroup=e},expression:"currentGroup"}},[a("a-radio-button",{attrs:{value:e.name,checked:0==n}},[t._v("\n        "+t._s(e.label)+"\n      ")])],1)}),t._v(" "),a("a-table",{attrs:{columns:t.tjcols,"data-source":t.tongji,scroll:{y:350},size:"small",pagination:!1}})],2)],1)],2)],1)},staticRenderFns:[]};e.a=n}});
//# sourceMappingURL=3.84107dd678c84b83cb66.js.map